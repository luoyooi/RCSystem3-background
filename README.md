# RCSystem3-background

#### 介绍
电影推荐系统的第三代，采用前后端分离的模式进行开发，这里主要介绍后端部分。第三代延续了第一二代的思想，但采用了全新的框架和技术来完成，逻辑上更严密，也更规范。
#### 项目搭建
整个项目的后端部分使用springboot进行搭建，mybatis负责持久层的交互，redis负责缓存的管理。数据库和缓存服务器均安装在linux虚拟机上，统一使用docker进行创建。ltp4j不再是手动导包，而是通过maven安装之后，使用maven坐标进行引入。
#### 数据获取
在第二代中，数据全部通过python爬虫获取，虽然能高效地获取到数据，但是由于技术有限，不能把数据爬取部分和J2EE合并在一起，形成一个完整的项目。在第三代中，数据获取部分还是使用爬虫，但是使用的是java爬虫，这样就能将爬取数据作为一个服务，嵌入到后台服务器中。
#### 主要业务流程
首先，开启一个定时任务，每隔一段时间调用爬虫模块获取一次最新的数据。当数据全部存入数据库以后，调用分词模块对评论信息进行分析，根据分数规则，对每条评论进行评分，最后计算出每个电影的综合得分。完成评分之后，将分词和评分结果与电影基本信息合并在一起，按照综合得分对合并后的数据进行排序，并根据条件，过滤掉不符合规则的一些分词结果，最后将数据分析的结果存入缓存。每次数据分析完成后，新的数据会覆盖旧的数据。前端访问相关接口，此时会去调用service层的获取数据分析结果的函数，该函数直接从缓存中拿数据（如果有的话，否则返回空），这样就不用每次都调用一次数据分析接口，一次次地进行分析然后再给前端数据。数据分析缓存结果会变化的唯一原因就是数据库数据变了，所以只需要在数据爬取完成后进行一次数据分析，更新一下缓存即可。
#### 其他
redis使用rdb的方式进行文件备份，由于没有涉及到大量的缓存操作，所以不需要用到aof，rdb已经足够。由于数据分析结果是需要长期保存的，这里设置为永不过期。